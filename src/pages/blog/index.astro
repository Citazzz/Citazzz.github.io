---
import BaseLayout from '../../layouts/BaseLayout.astro';
import SearchPanel from '../../components/SearchPanel.jsx';
import { getCollection } from 'astro:content';

// 1. 在服务器端获取所有文章
const allPosts = await getCollection('blog');
// 2. 按日期降序排列
const sortedPosts = allPosts.sort((a: { data: { pubDate: number; }; }, b: { data: { pubDate: number; }; }) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<BaseLayout title="Archives">
    <div class="mb-8">
        <h1 class="text-4xl font-black text-rhine-dark mb-2">ARCHIVES</h1>
        <p class="text-gray-500 font-mono text-sm">Total Logs: {sortedPosts.length}</p>
    </div>

    <!-- 3. 将数据传递给 React 组件，client:load 让它在浏览器端运行 -->
    <SearchPanel client:load posts={sortedPosts} />
</BaseLayout>	
